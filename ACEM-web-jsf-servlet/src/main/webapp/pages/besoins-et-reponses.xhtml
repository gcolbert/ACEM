<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:e="http://commons.esup-portail.org"
	template="../templates/template.xhtml">
	<ui:define name="content">
		<ui:debug hotkey="1" />
		<p:panel header="#{msgs['NEEDS_AND_ANSWERS.TREE.HEADER']}">
			<h:form id="formTree">
				<p:growl id="messages" showDetail="true" />
				<p:contextMenu id="contextMenu" for="treeSingle">
					<p:menuitem value="#{msgs['NEEDS_AND_ANSWERS.TREE.CONTEXT_MENU.VIEW_INFORMATION']}"
						update="treeSingle :formTree:messages"
						actionListener="#{besoinsReponsesController.displaySelectedSingle}"
						icon="ui-icon-search" />
					<p:menuitem value="#{msgs['NEEDS_AND_ANSWERS.TREE.CONTEXT_MENU.ADD_CHILD']}"
						update="treeSingle :formTree:messages"
						actionListener="#{besoinsReponsesController.addChildToSelectedNode}"
						icon="ui-icon-plus" />
					<p:menuitem value="#{msgs['NEEDS_AND_ANSWERS.TREE.CONTEXT_MENU.ASSOCIATE_ANSWER']}"
						update="treeSingle :formTree:messages"
						actionListener="#{besoinsReponsesController.addAnswerToSelectedNode}"
						icon="ui-icon-plus" />
					<p:menuitem value="#{msgs['NEEDS_AND_ANSWERS.TREE.CONTEXT_MENU.DELETE_NODE']}"
						update="treeSingle :formTree:messages"
						actionListener="#{besoinsReponsesController.deleteSelectedNode}"
						icon="ui-icon-minus" />
				</p:contextMenu>
				<p:tree id="treeSingle" orientation="vertical" dynamic="false"
					cache="false" value="#{besoinsReponsesController.treeRoot}"
					var="node" selectionMode="single"
					selection="#{besoinsReponsesController.selectedNode}"
					draggable="true" droppable="true" dragdropScope="demo">
					<p:ajax event="dragdrop"
						listener="#{besoinsReponsesController.onDragDrop}"
						update="treeSingle :formTree:messages" />
					<!-- 
					<p:ajax event="select" listener="#{besoinsReponsesController.onNodeSelect}" update="treeSingle :formTree:messages" />
					 -->
					<p:treeNode>
						<span onclick="this.parentNode.parentNode.firstChild.click();">
							<p:inplace editor="true" event="dblclick">
								<p:ajax event="save"
									listener="#{besoinsReponsesController.saveSelectedNode}"
									update="treeSingle" />
								<p:inputText value="#{node.label}" />
							</p:inplace>
						</span>
					</p:treeNode>
				</p:tree>
			</h:form>
		</p:panel>
		<p:panel header="#{msgs['NEEDS_AND_ANSWERS.SCENARIOS_EXAMPLES.HEADER']}">
			<h:form id="formExamples">
		<!-- 
				<p:dataTable id="cars" var="car" value="#{tableBean.smallCarsModel}"
					rowKey="#{car.model}" selection="#{tableBean.selectedCar}"
					selectionMode="single">
					<f:facet name="header">Click "View" button after selecting a row to see details</f:facet>
					<p:column headerText="Model">#{car.model}</p:column>
					<p:column headerText="Year">#{car.year}</p:column>
					<p:column headerText="Manufacturer">#{car.manufacturer}</p:column>
					<p:column headerText="Color">#{car.color}</p:column>
					<f:facet name="footer">
						<p:commandButton id="viewButton" value="View"
							icon="ui-icon-search" update=":formExamples:display"
							oncomplete="PF('carDialog').show()" />
					</f:facet>
				</p:dataTable>

				<p:dialog id="dialog" header="Car Detail" widgetVar="carDialog"
					resizable="false" width="200" showEffect="clip" hideEffect="fold">
					<h:panelGrid id="display" columns="2" cellpadding="4">

						<f:facet name="header">
							<p:graphicImage value="/images/cars/#{tableBean.selectedCar.manufacturer}.jpg" />
						</f:facet>

						<h:outputText value="Model:" />
						<h:outputText value="#{tableBean.selectedCar.model}" />

						<h:outputText value="Year:" />
						<h:outputText value="#{tableBean.selectedCar.year}" />

						<h:outputText value="Manufacturer:" />
						<h:outputText value="#{tableBean.selectedCar.manufacturer}" />

						<h:outputText value="Color:" />
						<h:outputText value="#{tableBean.selectedCar.color}" />
					</h:panelGrid>
				</p:dialog>
			 -->
			</h:form>
		</p:panel>
	</ui:define>
</ui:composition>