<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/commonLayout.xhtml">

	<f:metadata>
		<f:viewParam name="toolCategoryId" value="#{myToolsController.selectedToolCategoryId}" />
	</f:metadata>

	<!-- Controller associated with this view -->
	<ui:param name="associateBean" value="#{myToolsController}" />

	<!-- Control display of the layouts -->
	<ui:param name="displayNorth" value="true" />
	<ui:param name="northPanelCollapsible" value="true"/>
	<ui:param name="northPanelCollapsed" value="false"/>
	<ui:param name="displayWest" value="true" />
	<ui:param name="westPanelSize" value="350" />
	<ui:param name="westPanelCollapsible" value="true"/>
	<ui:param name="westPanelCollapsed" value="#{associateBean.selectedToolCategoryId!=null}" />
	<ui:param name="displayEast" value="#{associateBean.currentUserViewBean.administrator}" />
	<ui:param name="eastPanelSize" value="400" />
	<ui:param name="eastPanelCollapsible" value="true"/>
	<ui:param name="eastPanelCollapsed" value="#{associateBean.selectedToolCategoryId!=null}" />
	<ui:param name="displaySouth" value="true" />

	<ui:param name="pageTitle" value="#{associateBean.pageTitle}" />
	<ui:param name="titleContent" value="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.HEADER']}" />
	<ui:param name="titleWest" value="#{msg['MY_TOOLS.TREE.HEADER']}" />
	<ui:param name="titleEast" value="#{msg['TOOL_CATEGORIES.HEADER']}" />
	<ui:param name="titleSouth" value="#{msg['MY_TOOLS.MY_FAVORITE_TOOL_CATEGORIES.HEADER']}" />
	<ui:param name="titlePageOne" value="#{msg['MENU.MY_TOOLS']}"/>
	<ui:param name="titlePageTwo" value=""/>

	<ui:define name="footer">
		<p:outputPanel styleClass="bottomToolboxPanel">
			<p:panel id="favoriteToolCategoriesPanel" styleClass="favoriteToolCategoriesPanel"
				rendered="#{associateBean.currentUserViewBean.isTeacher}">
				<ui:repeat id="favoriteToolCategories"
					value="#{associateBean.currentUserViewBean.favoriteToolCategoryViewBeans}"
					var="toolCategoryViewBean">
					<h:outputLink id="goToToolCategoryBtn" outcome="my-tools">
						<f:param name="toolCategoryId"
							value="#{toolCategoryViewBean.id}" />
						<h:outputText value="#{toolCategoryViewBean.name}"
							rendered="#{empty toolCategoryViewBean.iconFileName}" />
						<p:graphicImage id="favoriteToolCategoryIcon"
							rendered="#{not empty toolCategoryViewBean.iconFileName}"
							styleClass="toolCategoryLogo"
							alt="#{toolCategoryViewBean.name}" cache="true" width="50"
							value="#{imagesController.image}">
							<f:param name="imageFileName"
								value="#{toolCategoryViewBean.iconFileName}" />
						</p:graphicImage>
					</h:outputLink>
					<p:tooltip for="goToToolCategoryBtn"
						value="#{toolCategoryViewBean.name}" />
				</ui:repeat>
			</p:panel>
<!-- 
			<p:panel header="#{msg['MY_TOOLS.LAST_VIEWED_TOOL_CATEGORIES.HEADER']}" styleClass="lastViewedToolCategoriesPanel">
			</p:panel>
 -->
		</p:outputPanel>
	</ui:define>

	<ui:define name="west">
		<p:outputPanel styleClass="toolCategoriesOutputPanel">
			<p:commandLink styleClass="toolCategoryMenuEntry"
				action="#{associateBean.prepareToolCategoryTreeForResourceType('RESOURCE_TYPE_EQUIPMENT')}"
				update="categoriesTree :contentForm:selectedToolCategoryOutputPanel"
				onclick="selectMenuitemLink('.toolCategoriesOutputPanel',this); history.pushState('','','my-tools');">
				<h:graphicImage
					url="resources/images/my-tools/my-tools.equipments.png"
					alt="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.EQUIPMENT.LABEL']}"
					styleClass="toolCategoryIcon" />
				<span class="toolCategoryLabel"><h:outputText
						value="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.EQUIPMENT.LABEL']}" /></span>
			</p:commandLink>
			<p:commandLink styleClass="toolCategoryMenuEntry"
				action="#{associateBean.prepareToolCategoryTreeForResourceType('RESOURCE_TYPE_SOFTWARE')}"
				update="categoriesTree :contentForm:selectedToolCategoryOutputPanel"
				onclick="selectMenuitemLink('.toolCategoriesOutputPanel',this); history.pushState('','','my-tools');">
				<h:graphicImage
					url="resources/images/my-tools/my-tools.softwares.png"
					alt="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.SOFTWARE.LABEL']}"
					styleClass="toolCategoryIcon" />
				<span class="toolCategoryLabel"><h:outputText
						value="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.SOFTWARE.LABEL']}" /></span>
			</p:commandLink>
			<p:commandLink styleClass="toolCategoryMenuEntry"
				action="#{associateBean.prepareToolCategoryTreeForResourceType('RESOURCE_TYPE_SOFTWARE_DOCUMENTATION')}"
				update="categoriesTree :contentForm:selectedToolCategoryOutputPanel"
				onclick="selectMenuitemLink('.toolCategoriesOutputPanel',this); history.pushState('','','my-tools');">
				<h:graphicImage
					url="resources/images/my-tools/my-tools.software-documentations.png"
					alt="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.SOFTWARE_DOCUMENTATION.LABEL']}"
					styleClass="toolCategoryIcon" />
				<span class="toolCategoryLabel"><h:outputText
						value="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.SOFTWARE_DOCUMENTATION.LABEL']}" /></span>
			</p:commandLink>
			<p:commandLink styleClass="toolCategoryMenuEntry"
				action="#{associateBean.prepareToolCategoryTreeForResourceType('RESOURCE_TYPE_PEDAGOGICAL_AND_DOCUMENTARY_RESOURCE')}"
				update="categoriesTree :contentForm:selectedToolCategoryOutputPanel"
				onclick="selectMenuitemLink('.toolCategoriesOutputPanel',this); history.pushState('','','my-tools');">
				<h:graphicImage
					url="resources/images/my-tools/my-tools.pedagogical-and-documentary-resources.png"
					alt="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.PEDAGOGICAL_AND_DOCUMENTARY_RESOURCES.LABEL']}"
					styleClass="toolCategoryIcon" />
				<span class="toolCategoryLabel"><h:outputText
						value="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.PEDAGOGICAL_AND_DOCUMENTARY_RESOURCES.LABEL']}" /></span>
			</p:commandLink>
			<p:commandLink styleClass="toolCategoryMenuEntry"
				action="#{associateBean.prepareToolCategoryTreeForResourceType('RESOURCE_TYPE_PROFESSIONAL_TRAINING')}"
				update="categoriesTree :contentForm:selectedToolCategoryOutputPanel"
				onclick="selectMenuitemLink('.toolCategoriesOutputPanel',this); history.pushState('','','my-tools');">
				<h:graphicImage
					url="resources/images/my-tools/my-tools.professional-trainings.png"
					alt="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.PROFESSIONAL_TRAININGS.LABEL']}"
					styleClass="toolCategoryIcon" />
				<span class="toolCategoryLabel"><h:outputText
						value="#{msg['MY_TOOLS.TREE.VISIBLE_ROOTS.PROFESSIONAL_TRAININGS.LABEL']}" /></span>
			</p:commandLink>
		</p:outputPanel>

		<p:tree id="categoriesTree" styleClass="categoriesTree" dynamic="true"
			datakey="#{treeNodeData.id}"
			value="#{associateBean.categoriesTreeRoot}" var="treeNodeData"
			selectionMode="single"
			selection="#{associateBean.selectedNode}">
			<p:treeNode type="default" styleClass="#{treeNodeData.styleClass}">
				<h:outputText value="#{treeNodeData.label}" />
			</p:treeNode>
			<p:treeNode type="CategoryNode"
				styleClass="#{treeNodeData.styleClass}">
				<h:link id="goToToolCategoryBtn" outcome="my-tools">
					<f:param name="toolCategoryId" value="#{treeNodeData.id}" />
					<h:outputText value="#{treeNodeData.label}" />
				</h:link>
			</p:treeNode>
		</p:tree>
	</ui:define>

	<ui:define name="east">
		<ui:include src="/templates/include/commonListAllToolCategories.xhtml">
			<ui:param name="formToUpdate" value=":eastForm"/>
			<ui:param name="associateBean" value="#{associateBean}"/>
		</ui:include>
	</ui:define>

	<ui:define name="content">
		<p:outputPanel id="selectedToolCategoryOutputPanel">
			<p:panel styleClass="selectedToolCategoryPanel"
				id="selectedToolCategoryPanel"
				rendered="#{associateBean.selectedToolCategoryViewBean != null}">
				<h2><h:outputText
					value="#{associateBean.selectedToolCategoryViewBean.name}" /></h2>

				<p:panelGrid columns="2">
					<p:graphicImage id="toolCategoryIcon"
						rendered="#{not empty associateBean.selectedToolCategoryViewBean.iconFileName}"
						styleClass="toolImg"
						alt="#{associateBean.selectedToolCategoryViewBean.name}"
						cache="true" width="80" value="#{imagesController.image}">
						<f:param name="imageFileName"
							value="#{associateBean.selectedToolCategoryViewBean.iconFileName}" />
					</p:graphicImage>
					<p:column>
						<p:row>
							<h:outputText value="#{associateBean.selectedToolCategoryViewBean.description}" />
						</p:row>
						<p:row>
							<h:panelGroup styleClass="favoriteToolCategory">
								<p:selectBooleanCheckbox id="favoriteToolCategoryCheckbox"
									styleClass="favoriteToolCategoryCheckbox"
									value="#{associateBean.selectedToolCategoryViewBean.favoriteToolCategory}">
									<p:ajax
										update="@this :southForm:favoriteToolCategoriesPanel :contentForm:messagesDisplayer"
										listener="#{associateBean.toggleFavoriteToolCategoryForCurrentUser(associateBean.selectedToolCategoryViewBean)}" />
								</p:selectBooleanCheckbox>
								<p:outputLabel for="favoriteToolCategoryCheckbox"
									value="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.ADD_TO_MY_FAVORITE_TOOLS']}" />
							</h:panelGroup>
						</p:row>
					</p:column>
				</p:panelGrid>

				<p:dataTable id="toolsDataTable" var="toolViewBean" dynamic="true"
					value="#{associateBean.selectedToolCategoryViewBean.resourceViewBeans}"
					selection="#{associateBean.selectedResourceViewBean}"
					emptyMessage="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.LIST.NO_RECORDS_FOUND']}"
					rowKey="#{toolViewBean.id}">
					<p:ajax event="rowSelectRadio"
						listener="#{associateBean.onToolRowSelect}" process="@this"
						update=":contentForm:idModifyToolButton :contentForm:idDeleteToolButton" />
					<p:column
						rendered="#{associateBean.currentUserViewBean.administrator}"
						selectionMode="single" style="width:16px;text-align:center"
						update=":contentForm:idModifyToolButton :contentForm:idDeleteToolButton" />
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.TOOL_NAME']}">
						<h:outputText value="#{toolViewBean.name}" />
						<p:graphicImage id="resourceIcon"
							rendered="#{not empty toolViewBean.iconFileName}"
							styleClass="toolIcon" alt="#{toolViewBean.name}"
							cache="true" width="40" value="#{imagesController.image}">
							<f:param name="imageFileName"
								value="#{toolViewBean.iconFileName}" />
						</p:graphicImage>
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.OWNER_ORGANISATION_NAME']}">
						<h:outputText
							value="#{toolViewBean.organisationPossessingResourceViewBean.name}" />
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.SUPPORT_ORGANISATION_NAME']}">
						<h:link id="goToSupportServiceBtn" outcome="my-services"
							rendered="#{toolViewBean.organisationSupportingResourceViewBean != null}">
							<f:param name="serviceId"
								value="#{toolViewBean.organisationSupportingResourceViewBean.id}" />
							<h:outputText
								value="#{toolViewBean.organisationSupportingResourceViewBean.name}" />
							<h:outputText styleClass="ui-icon ui-icon-arrowthickstop-1-e"
								style="display:inline-block; vertical-align:middle;" />
							<p:tooltip
								value="#{msg['GO_TO_TOOL_SUPPORT_SERVICE.TOOLTIP']}"
								for="goToSupportServiceBtn" />
						</h:link>
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.ORGANISATIONS_HAVING_ACCESS_TO_RESOURCE']}">
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.USE_MODES']}">
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.AVAILABILITY']}">
					</p:column>
				</p:dataTable>
				<p:panel styleClass="resourcesDataTableActionsPanel" rendered="#{associateBean.currentUserViewBean.administrator}">
					<p:commandButton
						value="#{msg['MY_TOOLS.CREATE_RESOURCE_LABEL']}"
						icon="ui-icon-plusthick" update=":createResourceForm:idDialogCreateResource"
						action="#{associateBean.prepareResourceCreation}"
						oncomplete="PF('dialogCreateResource').show()">
						<p:resetInput target=":createResourceForm:idDialogCreateResource" />
					</p:commandButton>
					<p:commandButton id="idModifyToolButton"
						value="#{msg['MY_TOOLS.MODIFY_RESOURCE_LABEL']}"
						icon="ui-icon-pencil" update=":modifyResourceForm:idDialogModifyResource"
						action="#{associateBean.prepareResourceModification(associateBean.selectedResourceViewBean)}"
						oncomplete="PF('dialogModifyResource').show()"
						disabled="#{associateBean.selectedResourceViewBean == null}">
						<p:resetInput target=":modifyResourceForm:idDialogModifyResource" />
					</p:commandButton>
					<p:commandButton id="idDeleteToolButton"
						disabled="#{associateBean.selectedResourceViewBean == null}"
						value="#{msg['MY_TOOLS.DELETE_RESOURCE_LABEL']}"
						icon="ui-icon-trash"
						action="#{associateBean.onDeleteSelectedResource}"
						update="toolsDataTable :contentForm:messagesDisplayer"
						process="@this">
						<p:confirm
							header="#{msg['MY_TOOLS.DELETE_RESOURCE.CONFIRMATION_HEADER']}"
							message="#{msg['MY_TOOLS.DELETE_RESOURCE.CONFIRMATION_QUESTION']}"
							icon="ui-icon-alert" />
					</p:commandButton>
				</p:panel>

				<h3 class="section-title"><p:outputLabel
					value="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.ASSOCIATED_PEDAGOGICAL_ADVICE_LABEL']}" /></h3>
				<p:tree id="pedagogicalUsesTree" styleClass="pedagogicalAdviceTree notSelectableTree" dynamic="false"
					value="#{associateBean.pedagogicalUsesTreeRoot}"
					var="treeNodeData">
					<p:treeNode type="default"
						styleClass="#{treeNodeData.styleClass}">
						<h:outputText value="#{treeNodeData.label}" />
					</p:treeNode>
					<p:treeNode type="#{associateBean.treeNodeType_NEED_LEAF}"
						styleClass="#{treeNodeData.styleClass}">
						<h:outputText value="#{treeNodeData.label}" />
					</p:treeNode>
					<p:treeNode
						type="#{associateBean.treeNodeType_NEED_WITH_ASSOCIATED_NEEDS}"
						styleClass="#{treeNodeData.styleClass}">
						<h:outputText value="#{treeNodeData.label}" />
					</p:treeNode>
					<p:treeNode
						type="#{associateBean.treeNodeType_NEED_WITH_ASSOCIATED_ANSWERS}"
						styleClass="#{treeNodeData.styleClass}">
						<h:outputText value="#{treeNodeData.label}" />
					</p:treeNode>
					<p:treeNode
						type="#{associateBean.treeNodeType_ANSWER_LEAF}"
						styleClass="#{treeNodeData.styleClass}">
						<h:outputText value="#{treeNodeData.label}" />
					</p:treeNode>
				</p:tree>

				<h3 class="section-title"><h:outputText
					value="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.SCENARIOS_USING_SELECTED_TOOL_CATEGORY_LABEL']}" /></h3>

				<p:dataTable id="scenariosUsingSelectedToolCategoryTable"
					value="#{associateBean.selectedToolCategoryViewBean.scenarioViewBeans}"
					emptyMessage="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.SCENARIOS.LIST.NO_RECORDS_FOUND']}"
					var="scenario">
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.SCENARIOS.COLUMNS.TITLE']}">
						<h:link id="goToScenarioBtn" outcome="my-scenarios">
							<f:param name="scenarioId" value="#{scenario.id}" />
							<h:outputText value="#{scenario.name}" />
							<h:outputText styleClass="ui-icon ui-icon-arrowthickstop-1-e"
								style="display:inline-block; vertical-align:middle;" />
							<p:tooltip
								value="#{msg['GO_TO_SCENARIO.TOOLTIP']}"
								for="goToScenarioBtn" />
						</h:link>
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.SCENARIOS.COLUMNS.OBJECTIVE']}">
						<h:outputText value="#{scenario.objective}" />
					</p:column>
					<p:column
						headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.SCENARIOS.COLUMNS.AUTHOR']}">
						<h:outputText value="#{scenario.authors}" />
					</p:column>
				</p:dataTable>
			</p:panel>
		</p:outputPanel>
	</ui:define>

	<ui:define name="customDialogOutFormWithoutForm">

		<h:form id="createToolCategoryForm">
			<ui:include src="/templates/include/commonCreateOrModifyToolCategoryDialog.xhtml">
				<ui:param name="associateBean" value="#{associateBean}"/>
				<ui:param name="widgetName" value="dialogCreateToolCategory"/>
				<ui:param name="formToUpdate" value=":eastForm"/>
				<ui:param name="dialogHeader" value="#{msg['TOOL_CATEGORIES.CREATE_TOOL_CATEGORY_MODAL_WINDOW.HEADER']}"/>
			</ui:include>
		</h:form>

		<h:form id="modifyToolCategoryForm">
			<ui:include src="/templates/include/commonCreateOrModifyToolCategoryDialog.xhtml">
				<ui:param name="associateBean" value="#{associateBean}"/>
				<ui:param name="widgetName" value="dialogModifyToolCategory"/>
				<ui:param name="formToUpdate" value=":eastForm"/>
				<ui:param name="dialogHeader" value="#{msg['TOOL_CATEGORIES.MODIFY_TOOL_CATEGORY_MODAL_WINDOW.HEADER']}"/>
			</ui:include>
		</h:form>

		<h:form id="createResourceForm">
			<p:dialog id="idDialogCreateResource"
				header="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.HEADER']}"
				widgetVar="dialogCreateResource" modal="true" height="auto">
				<p:ajax event="close" listener="#{associateBean.onCloseDialogWithUploadedFile}" />
				<p:panelGrid>
					<p:row>
						<p:column>
							<h:outputLabel for="category"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.CATEGORY_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<h:outputText id="category"
								value="#{associateBean.selectedToolCategoryViewBean.name}" />
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="type"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.TYPE_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:selectOneMenu id="type" required="true"
								requiredMessage="#{msg['REQUIRED_FIELD']}" editable="false" var="p"
								immediate="true" binding="#{newResourceType}">
								<f:selectItem
									itemLabel="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.SELECT_TOOL_TYPE']}"
									itemValue="" itemDisabled="true" noSelectionOption="true" />
								<f:selectItems value="#{associateBean.allResourceTypes}" var="resourceType"
									itemValue="#{resourceType}" itemLabel="#{msg[resourceType]}"/>
							</p:selectOneMenu>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="name"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.NAME_LABEL']}" />
						</p:column>
						<p:column>
							<p:inputText id="name" required="true"
								requiredMessage="#{msg['REQUIRED_FIELD']}" size="50"
								binding="#{newResourceName}" />
						</p:column>
						<p:column>
							<p:message for="name" display="text" />
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="icon"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.ICON_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:outputPanel id="iconOutputPanel">
								<p:panel id="icon" styleClass="iconPanel">
									<p:graphicImage
										rendered="#{(not empty associateBean.selectedResourceViewBean.iconFileName) and (empty associateBean.temporaryFilePath)}"
										alt="#{associateBean.selectedResourceViewBean.name}"
										cache="true" width="200" value="#{imagesController.image}">
										<f:param name="imageFileName"
											value="#{associateBean.selectedResourceViewBean.iconFileName}" />
									</p:graphicImage>
									<p:graphicImage
										rendered="#{not empty associateBean.temporaryFilePath}"
										alt="#{associateBean.selectedResourceViewBean.name}"
										cache="true" width="200" value="#{imagesController.image}">
										<f:param name="imageFilePath"
											value="#{associateBean.temporaryFilePath}" />
									</p:graphicImage>
								</p:panel>
								<p:commandButton title="#{msg['APPLICATION.BUTTON.SELECT']}"
									icon="ui-icon-cart" oncomplete="PF('dialogUploadOneImage').show()"
									process="@this" />
								<p:commandButton id="deleteIconButton" title="#{msg['APPLICATION.BUTTON.DELETE']}"
									disabled="#{empty associateBean.temporaryFilePath}"
									icon="ui-icon-trash" action="#{associateBean.removeResourceIcon(null)}"
									update="@this icon"
									process="@this" />
							</p:outputPanel>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="ownerOrganisation"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.OWNER_ORGANISATION_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:selectOneMenu id="ownerOrganisation"
								required="true" requiredMessage="#{msg['REQUIRED_FIELD']}"
								editable="false" immediate="true"
								binding="#{newResourceOwnerOrganisation}"
								converter="OrganisationConverter">
								<f:selectItem
									itemLabel="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.SELECT_OWNER_ORGANISATION']}"
									itemValue="" itemDisabled="true" noSelectionOption="true" />
								<f:selectItems
									value="#{associateBean.allOrganisationViewBeans}"
									var="organisationViewBean"
									itemLabel="#{organisationViewBean.name}"
									itemValue="#{organisationViewBean}" />
							</p:selectOneMenu>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="supportService"
								value="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.SUPPORT_ORGANISATION_LABEL']}" />
						</p:column>
						<p:column>
							<p:selectOneMenu id="supportService"
								required="true" requiredMessage="#{msg['REQUIRED_FIELD']}"
								editable="false" immediate="true"
								binding="#{newResourceSupportOrganisation}"
								converter="OrganisationConverter">
								<f:selectItem
									itemLabel="#{msg['MY_TOOLS.CREATE_RESOURCE_MODAL_WINDOW.SELECT_SUPPORT_ORGANISATION']}"
									itemValue="" itemDisabled="true" noSelectionOption="true" />
								<f:selectItems
									value="#{associateBean.allOrganisationViewBeans}"
									var="organisationViewBean"
									itemLabel="#{organisationViewBean.name}"
									itemValue="#{organisationViewBean}" />
							</p:selectOneMenu>
						</p:column>
						<p:column>
							<p:message for="supportService" display="text" />
						</p:column>
					</p:row>

 				</p:panelGrid>
				<p:commandButton styleClass="dialogValidationButton"
					value="#{msg['APPLICATION.BUTTON.SAVE']}"
					icon="ui-icon-check" validateClient="true"
					action="#{associateBean.onCreateResource(newResourceType.value, newResourceOwnerOrganisation.value, newResourceSupportOrganisation.value, newResourceName.value)}"
					process="@form" update="@this :contentForm:toolsDataTable :contentForm:messagesDisplayer"
					oncomplete="if (args &amp;&amp; !args.validationFailed) { PF('dialogCreateResource').hide(); }"/>
			</p:dialog>
		</h:form>

		<h:form id="modifyResourceForm">
			<p:dialog id="idDialogModifyResource"
				header="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.HEADER']}"
				widgetVar="dialogModifyResource" modal="true" height="auto">
				<p:ajax event="close" listener="#{associateBean.onCloseDialogWithUploadedFile}" />
				<p:panelGrid
					rendered="#{associateBean.selectedResourceViewBean != null}">
					<p:row>
						<p:column>
							<h:outputLabel for="categoryForTheExistingResource"
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.CATEGORY_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<h:outputText id="categoryForTheExistingResource"
								value="#{associateBean.selectedToolCategoryViewBean.name}" />
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="name"
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.NAME_LABEL']}" />
						</p:column>
						<p:column>
							<p:inputText id="name" required="true"
								value="#{associateBean.selectedResourceViewBean.name}"
								requiredMessage="#{msg['REQUIRED_FIELD']}" size="50" />
						</p:column>
						<p:column>
							<p:message for="name" display="text" />
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.ICON_LABEL']}"
								for="icon" />
						</p:column>
						<p:column colspan="2">
							<p:outputPanel id="iconOutputPanel">
								<p:panel id="icon" styleClass="iconPanel">
									<p:graphicImage
										rendered="#{(not empty associateBean.selectedResourceViewBean.iconFileName) and (empty associateBean.temporaryFilePath)}"
										alt="#{associateBean.selectedResourceViewBean.name}"
										cache="true" width="200" value="#{imagesController.image}">
										<f:param name="imageFileName"
											value="#{associateBean.selectedResourceViewBean.iconFileName}" />
									</p:graphicImage>
									<p:graphicImage
										rendered="#{not empty associateBean.temporaryFilePath}"
										alt="#{associateBean.selectedResourceViewBean.name}"
										cache="true" width="200" value="#{imagesController.image}">
										<f:param name="imageFilePath"
											value="#{associateBean.temporaryFilePath}" />
									</p:graphicImage>
								</p:panel>
								<p:commandButton title="#{msg['APPLICATION.BUTTON.SELECT']}"
									icon="ui-icon-cart" oncomplete="PF('dialogUploadOneImage').show()"
									process="@this" />
								<p:commandButton id="deleteIconButton" title="#{msg['APPLICATION.BUTTON.DELETE']}"
									disabled="#{(empty associateBean.selectedResourceViewBean.iconFileName) and (empty associateBean.temporaryFilePath)}"
									icon="ui-icon-trash" action="#{associateBean.removeResourceIcon(associateBean.selectedResourceViewBean)}"
									update="@this icon"
									process="@this" />
							</p:outputPanel>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="ownerOrganisation"
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.OWNER_ORGANISATION_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:selectOneMenu id="ownerOrganisation"
								required="true" requiredMessage="#{msg['REQUIRED_FIELD']}"
								editable="false" immediate="true"
								value="#{associateBean.selectedResourceViewBean.organisationPossessingResourceViewBean}"
								converter="OrganisationConverter">
								<f:selectItem
									itemLabel="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.SELECT_OWNER_ORGANISATION']}"
									itemValue="" itemDisabled="true" noSelectionOption="true" />
								<f:selectItems
									value="#{associateBean.allOrganisationViewBeans}"
									var="organisationViewBean"
									itemLabel="#{organisationViewBean.name}"
									itemValue="#{organisationViewBean}" />
							</p:selectOneMenu>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="supportOrganisation"
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.SUPPORT_ORGANISATION_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:selectOneMenu id="supportOrganisation"
								required="true" requiredMessage="#{msg['REQUIRED_FIELD']}"
								editable="false" immediate="true"
								value="#{associateBean.selectedResourceViewBean.organisationSupportingResourceViewBean}"
								converter="OrganisationConverter">
								<f:selectItem
									itemLabel="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.SELECT_SUPPORT_ORGANISATION']}"
									itemValue="" itemDisabled="true" noSelectionOption="true" />
								<f:selectItems
									value="#{associateBean.allOrganisationViewBeans}"
									var="organisationViewBean"
									itemLabel="#{organisationViewBean.name}"
									itemValue="#{organisationViewBean}" />
							</p:selectOneMenu>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<h:outputLabel for="useModes"
								value="#{msg['MY_TOOLS.MODIFY_RESOURCE_MODAL_WINDOW.USE_MODES_LABEL']}" />
						</p:column>
						<p:column colspan="2">
							<p:dataTable id="useModes"
								value="#{associateBean.selectedResourceViewBean.useModeViewBeans}"
								emptyMessage="#{msg['APPLICATION.MESSAGE.NO_RECORD']}"
								var="useMode">
								<p:column
									headerText="#{msg['MY_TOOLS.SELECTED_RESOURCE_CATEGORY.TOOLS.COLUMN_HEADER.USE_MODES']}">
									<h:outputText value="#{useMode.name}" />
								</p:column>
							</p:dataTable>
						</p:column>
					</p:row>

				</p:panelGrid>

				<p:commandButton styleClass="dialogValidationButton"
					value="#{msg['APPLICATION.BUTTON.SAVE']}"
					icon="ui-icon-check" validateClient="true"
					action="#{associateBean.onModifySelectedResource}"
					process="@form"
					update=":contentForm:toolsDataTable :contentForm:messagesDisplayer"
					oncomplete="if (args &amp;&amp; !args.validationFailed) { PF('dialogModifyResource').hide(); }"/>
			</p:dialog>
		</h:form>

		<h:form id="associateUseModesForm">
			<p:dialog id="idDialogAssociateUseModes"
				header="#{msg['MY_TOOLS.ASSOCIATE_USE_MODE_MODAL_WINDOW.HEADER']}"
				widgetVar="dialogAssociateUseModes" modal="true" height="auto">

				<h:outputLabel
					value="#{msg['MY_TOOLS.ASSOCIATE_USE_MODE_MODAL_WINDOW.NEW_USE_MODE_LABEL']}"
					for="useMode" />
				<p:editor id="useMode"
					value="#{associateBean.selectedResourceViewBean.useModeViewBeans}"
					controls="bold bullets numbering undo redo link unlink">
				</p:editor>
			</p:dialog>
		</h:form>

	</ui:define>

	<ui:define name="customDialogOutForm">
		<ui:include src="/templates/include/commonUploadOneImageDialog.xhtml">
			<ui:param name="associateBean" value="#{associateBean}" />
		</ui:include>
	</ui:define>

</ui:composition>